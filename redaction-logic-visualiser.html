<!doctype html>
<html lang="en">
<head>
<script src="/js/consent-gate.js" defer></script>
<meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FOI Redaction Logic Visualiser | GlassCase</title>
  <meta name="description" content="Interactive map of the FOI redaction decision pathway (Commonwealth FOI Act). Visualise exemption tests, public interest steps, and release/refusal outcomes.">
  <meta name="author" content="Jay Spudvilas (Jayden Spudvilas-Powell)">
  <link rel="canonical" href="https://glasscase.org/redaction-logic-visualiser">
  <link rel="me" href="https://substack.com/@glasscase" />
  <link rel="me" href="https://glasscase.substack.com/" />

  <meta property="og:title" content="FOI Redaction Logic Visualiser | GlassCase" />
  <meta property="og:description" content="Interactive map of the FOI redaction decision pathway (Commonwealth FOI Act)." />
  <meta property="og:site_name" content="GlassCase" />
  <meta property="og:locale" content="en_AU" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://glasscase.org/redaction-logic-visualiser" />
  <meta property="og:image" content="https://glasscase.org/og-image.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="FOI Redaction Logic Visualiser | GlassCase" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="FOI Redaction Logic Visualiser | GlassCase" />
  <meta name="twitter:description" content="Interactive map of the FOI redaction decision pathway (Commonwealth FOI Act)." />
  <meta name="twitter:image" content="https://glasscase.org/og-image.png" />
  <meta name="twitter:image:alt" content="FOI Redaction Logic Visualiser | GlassCase" />
  <script>
  (function() {
    var t = localStorage.getItem('glasscase-theme');
    if (t === 'light') document.documentElement.setAttribute('data-theme', 'light');
  })();
</script>
<link rel="stylesheet" href="/css/style.css?v=2026-03-13" />

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://glasscase.org/redaction-logic-visualiser",
    "url": "https://glasscase.org/redaction-logic-visualiser",
    "name": "FOI Redaction Logic Visualiser | GlassCase",
    "description": "Interactive map of the FOI redaction decision pathway (Commonwealth FOI Act). Visualise exemption tests, public interest steps, and release/refusal outcomes.",
    "inLanguage": "en_AU",
    "author": {
      "@type": "Person",
      "name": "Jay Spudvilas",
      "alternateName": "Jayden Spudvilas-Powell",
      "url": "https://jayspudvilas.com/",
      "sameAs": [
        "https://linkedin.com/in/jayspudvilas",
        "https://orcid.org/0009-0000-0945-0380",
        "https://github.com/nuncprotunc",
        "https://substack.com/@glasscase",
        "https://glasscase.substack.com/"
      ]
    },
    "publisher": {
      "@type": "Organization",
      "name": "GlassCase",
      "url": "https://glasscase.org/"
    }
  }
  </script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: transparent;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js?v=2025-12-30"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js?v=2025-12-30"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js?v=2025-12-30"></script>

  <script type="text/babel">
    const { useEffect, useMemo, useState } = React;

    const RedactionFlowVisualizer = () => {
      const [activeStep, setActiveStep] = useState(null);
      const [activePath, setActivePath] = useState(null);
      const [theme, setTheme] = useState(
        document.documentElement.getAttribute('data-theme') === 'light' ? 'light' : 'dark'
      );

      const [isMobile, setIsMobile] = useState(false);

      const isLight = theme === 'light';

      const palette = useMemo(() => {
        if (isLight) {
          return {
            pageBg: 'linear-gradient(135deg, #f8fbff 0%, #f2f7fd 50%, #eef4fb 100%)',
            textPrimary: '#1a1a2e',
            textMuted: '#64748b',
            headingSolid: '#1a1a2e',
            disclaimerBg: '#eaf3ff',
            disclaimerBorder: '#c7ddf7',
            legendBg: '#f7fbff',
            legendBorder: '#d9e4f0',
            cardBg: '#f7fbff',
            cardBorder: '#d9e4f0',
            sectionBg: '#ffffff',
            sectionBorder: '#d9e4f0',
            descBg: '#eef4fb',
            noteStrong: '#1d4ed8',
            noteBg: '#eaf3ff',
            noteBorder: '#c7ddf7',
            attrBorder: '#d9e4f0',
            attrText: '#64748b',
            neutralArrow: '#64748b',
            chipReleaseBg: '#dcfce7',
            chipReleaseText: '#166534',
            chipRefuseBg: '#fee2e2',
            chipRefuseText: '#991b1b',
            finalReleaseBg: '#dcfce7',
            finalReleaseText: '#166534',
            finalReleaseSub: '#64748b',
          };
        }

        return {
          pageBg: 'linear-gradient(135deg, #0a1628 0%, #0f172a 50%, #1a2744 100%)',
          textPrimary: '#e2e8f0',
          textMuted: '#94a3b8',
          headingSolid: null,
          disclaimerBg: 'rgba(74,158,255,0.07)',
          disclaimerBorder: 'rgba(74,158,255,0.2)',
          legendBg: 'rgba(255,255,255,0.03)',
          legendBorder: 'rgba(255,255,255,0.1)',
          cardBg: 'rgba(255,255,255,0.02)',
          cardBorder: 'rgba(255,255,255,0.1)',
          sectionBg: 'rgba(255,255,255,0.01)',
          sectionBorder: 'rgba(255,255,255,0.08)',
          descBg: 'rgba(0,0,0,0.3)',
          noteStrong: '#60a5fa',
          noteBg: 'rgba(59, 130, 246, 0.1)',
          noteBorder: 'rgba(59, 130, 246, 0.3)',
          attrBorder: 'rgba(255,255,255,0.1)',
          attrText: '#64748b',
          neutralArrow: '#64748b',
          chipReleaseBg: 'rgba(34, 197, 94, 0.1)',
          chipReleaseText: '#86efac',
          chipRefuseBg: 'rgba(239, 68, 68, 0.08)',
          chipRefuseText: '#fca5a5',
          finalReleaseBg: 'rgba(34, 197, 94, 0.15)',
          finalReleaseText: '#86efac',
          finalReleaseSub: '#94a3b8',
        };
      }, [isLight]);

      useEffect(() => {
        if (typeof window === 'undefined' || !window.matchMedia) return;

        const mq = window.matchMedia('(max-width: 640px)');
        const update = () => setIsMobile(!!mq.matches);
        update();

        if (mq.addEventListener) {
          mq.addEventListener('change', update);
          return () => mq.removeEventListener('change', update);
        }

        mq.addListener(update);
        return () => mq.removeListener(update);
      }, []);

      useEffect(() => {
        function applyTheme(nextTheme) {
          const safeTheme = nextTheme === 'light' ? 'light' : 'dark';
          setTheme(safeTheme);
          if (safeTheme === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
          } else {
            document.documentElement.removeAttribute('data-theme');
          }
        }

        function onMessage(event) {
          if (!event || !event.data) return;
          if (event.data.type === 'glasscaseTheme') {
            applyTheme(event.data.theme);
          }
        }

        function onStorage(event) {
          if (!event || event.key !== 'glasscase-theme') return;
          applyTheme(event.newValue === 'light' ? 'light' : 'dark');
        }

        window.addEventListener('message', onMessage);
        window.addEventListener('storage', onStorage);

        return () => {
          window.removeEventListener('message', onMessage);
          window.removeEventListener('storage', onStorage);
        };
      }, []);

      const steps = {
        start: {
          id: 'start',
          label: 'Document requested under FOI',
          section: null,
          type: 'start'
        },
        exemption: {
          id: 'exemption',
          label: 'Apply exemption test',
          section: 'Part IV',
          description: 'Does an exemption apply to the document or part of it?',
          type: 'decision',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/index.html#p4'
        },
        division2: {
          id: 'division2',
          label: 'Division 2: Absolute exemption',
          section: 'ss 33–47A',
          description: 'National security, Cabinet, law enforcement, legal privilege, trade secrets, etc.',
          type: 'exemption-absolute',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/index.html#p4-d2'
        },
        division3: {
          id: 'division3',
          label: 'Division 3: Conditional exemption',
          section: 'ss 47B–47J',
          description: 'Personal privacy, deliberative processes, business affairs, agency operations, etc.',
          type: 'exemption-conditional',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/index.html#p4-d3'
        },
        publicInterest: {
          id: 'publicInterest',
          label: 'Apply public interest test',
          section: 's 11A(5), s 11B',
          description: 'Would access be contrary to public interest? Weigh factors for and against disclosure.',
          type: 'decision',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/s11b.html'
        },
        editedCopy: {
          id: 'editedCopy',
          label: 'Prepare edited copy',
          section: 's 22',
          description: 'Delete exempt matter if reasonably practicable. Provide meaningful access to remainder.',
          type: 'process',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/s22.html'
        },
        reasons: {
          id: 'reasons',
          label: 'Provide reasons for decision',
          section: 's 26',
          description: 'State findings on material questions of fact, reasons for refusal, and public interest factors.',
          type: 'process',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/s26.html'
        },
        release: {
          id: 'release',
          label: 'Release document',
          section: 's 11A(3)',
          description: 'Provide access in accordance with request.',
          type: 'outcome-release',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/s11a.html'
        },
        refuse: {
          id: 'refuse',
          label: 'Refuse access',
          section: 's 11A(4)',
          description: 'Document is exempt. Applicant has review rights.',
          type: 'outcome-refuse',
          link: 'http://classic.austlii.edu.au/au/legis/cth/consol_act/foia1982222/s11a.html'
        }
      };

      const paths = {
        noExemption: {
          id: 'noExemption',
          label: 'No exemption applies',
          from: 'exemption',
          to: 'release',
          color: '#22c55e'
        },
        absolute: {
          id: 'absolute',
          label: 'Absolute exemption (Div 2)',
          from: 'exemption',
          to: 'division2',
          color: '#ef4444'
        },
        conditional: {
          id: 'conditional',
          label: 'Conditional exemption (Div 3)',
          from: 'exemption',
          to: 'division3',
          color: '#f59e0b'
        },
        absoluteToEdit: {
          id: 'absoluteToEdit',
          label: 'Exempt matter identified',
          from: 'division2',
          to: 'editedCopy',
          color: '#ef4444'
        },
        conditionalToPIT: {
          id: 'conditionalToPIT',
          label: 'Proceed to PIT',
          from: 'division3',
          to: 'publicInterest',
          color: '#f59e0b'
        },
        pitFavours: {
          id: 'pitFavours',
          label: 'PIT favours access',
          from: 'publicInterest',
          to: 'release',
          color: '#22c55e'
        },
        pitAgainst: {
          id: 'pitAgainst',
          label: 'PIT contrary to access',
          from: 'publicInterest',
          to: 'editedCopy',
          color: '#ef4444'
        },
        editToReasons: {
          id: 'editToReasons',
          label: 'Prepare notice',
          from: 'editedCopy',
          to: 'reasons',
          color: '#60a5fa'
        },
        reasonsToRelease: {
          id: 'reasonsToRelease',
          label: 'Edited copy released',
          from: 'reasons',
          to: 'release',
          color: '#22c55e'
        }
      };

      const getStepStyle = (step) => {
        const baseStyle = {
          padding: '12px 16px',
          borderRadius: '8px',
          cursor: 'pointer',
          transition: 'all 0.2s ease',
          border: '2px solid',
          textAlign: 'center',
          minWidth: '180px'
        };

        const isActive = activeStep === step.id;

        const typeStyles = isLight ? {
          'start': {
            background: isActive ? '#dbeafe' : '#f4f8ff',
            borderColor: '#3b82f6',
            color: '#1e3a8a'
          },
          'decision': {
            background: isActive ? '#dbeafe' : '#eff6ff',
            borderColor: '#3b82f6',
            color: '#1e40af',
            transform: 'rotate(0deg)'
          },
          'exemption-absolute': {
            background: isActive ? '#fee2e2' : '#fff1f1',
            borderColor: '#ef4444',
            color: '#991b1b'
          },
          'exemption-conditional': {
            background: isActive ? '#fef3c7' : '#fff8e8',
            borderColor: '#f59e0b',
            color: '#92400e'
          },
          'process': {
            background: isActive ? '#dbeafe' : '#eff6ff',
            borderColor: '#60a5fa',
            color: '#1e40af'
          },
          'outcome-release': {
            background: isActive ? '#dcfce7' : '#ecfdf5',
            borderColor: '#22c55e',
            color: '#166534'
          },
          'outcome-refuse': {
            background: isActive ? '#fee2e2' : '#fff1f1',
            borderColor: '#ef4444',
            color: '#991b1b'
          }
        } : {
          'start': {
            background: isActive ? '#1e3a5f' : '#0f172a',
            borderColor: '#3b82f6',
            color: '#e2e8f0'
          },
          'decision': {
            background: isActive ? '#1e3a5f' : 'rgba(59, 130, 246, 0.1)',
            borderColor: '#3b82f6',
            color: '#e2e8f0',
            transform: 'rotate(0deg)'
          },
          'exemption-absolute': {
            background: isActive ? '#7f1d1d' : 'rgba(239, 68, 68, 0.1)',
            borderColor: '#ef4444',
            color: '#fca5a5'
          },
          'exemption-conditional': {
            background: isActive ? '#78350f' : 'rgba(245, 158, 11, 0.1)',
            borderColor: '#f59e0b',
            color: '#fcd34d'
          },
          'process': {
            background: isActive ? '#1e3a5f' : 'rgba(96, 165, 250, 0.1)',
            borderColor: '#60a5fa',
            color: '#93c5fd'
          },
          'outcome-release': {
            background: isActive ? '#14532d' : 'rgba(34, 197, 94, 0.1)',
            borderColor: '#22c55e',
            color: '#86efac'
          },
          'outcome-refuse': {
            background: isActive ? '#7f1d1d' : 'rgba(239, 68, 68, 0.1)',
            borderColor: '#ef4444',
            color: '#fca5a5'
          }
        };

        return { ...baseStyle, ...typeStyles[step.type] };
      };

      const StepBox = ({ step, style = {} }) => (
        <div
          style={{ ...getStepStyle(step), ...style }}
          onMouseEnter={() => setActiveStep(step.id)}
          onMouseLeave={() => setActiveStep(null)}
          onClick={() => {
            if (!step.link) return;
            const newWin = window.open(step.link, '_blank', 'noopener,noreferrer');
            if (newWin) newWin.opener = null;
          }}
        >
          <div style={{ fontWeight: 600, fontSize: '14px', marginBottom: '4px' }}>
            {step.label}
          </div>
          {step.section && (
            <div style={{ fontSize: '12px', opacity: 0.8, fontFamily: 'monospace' }}>
              {step.section}
            </div>
          )}
          {activeStep === step.id && step.description && (
            <div style={{
              fontSize: '11px',
              marginTop: '8px',
              padding: '8px',
              background: palette.descBg,
              borderRadius: '4px',
              textAlign: 'left'
            }}>
              {step.description}
            </div>
          )}
        </div>
      );

      const Arrow = ({ direction = 'down', label, color = '#64748b', style = {} }) => (
        <div style={{
          display: 'flex',
          flexDirection: direction === 'down' ? 'column' : 'row',
          alignItems: 'center',
          padding: '8px',
          ...style
        }}>
          {label && (
            <span style={{
              fontSize: '11px',
              color: color,
              marginBottom: direction === 'down' ? '4px' : 0,
              marginRight: direction === 'right' ? '8px' : 0,
              whiteSpace: 'nowrap'
            }}>
              {label}
            </span>
          )}
          <svg
            width={direction === 'down' ? '24' : '40'}
            height={direction === 'down' ? '24' : '24'}
            viewBox={direction === 'down' ? '0 0 24 24' : '0 0 40 24'}
          >
            {direction === 'down' ? (
              <path d="M12 4 L12 16 M8 12 L12 16 L16 12" stroke={color} strokeWidth="2" fill="none" strokeLinecap="round" strokeLinejoin="round"/>
            ) : (
              <path d="M4 12 L32 12 M28 8 L32 12 L28 16" stroke={color} strokeWidth="2" fill="none" strokeLinecap="round" strokeLinejoin="round"/>
            )}
          </svg>
        </div>
      );

      return (
        <div style={{
          background: palette.pageBg,
          padding: '32px',
          fontFamily: "'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",
          color: palette.textPrimary
        }}>
          <div style={{ maxWidth: '900px', margin: '0 auto' }}>
            {/* Header */}
            <div style={{ marginBottom: '32px' }}>
              <div className="pill-primary" style={{ marginBottom: '12px' }}>
                VISUALISER
              </div>
              <h1 style={{
                fontSize: '28px',
                fontWeight: 700,
                marginBottom: '8px',
                ...(isLight
                  ? { color: palette.headingSolid }
                  : {
                      background: 'linear-gradient(135deg, #e2e8f0 0%, #60a5fa 100%)',
                      WebkitBackgroundClip: 'text',
                      WebkitTextFillColor: 'transparent'
                    })
              }}>
                FOI Redaction Logic
              </h1>
              <p style={{ color: palette.textMuted, fontSize: '16px' }}>
                The decision pathway from request to release under the FOI Act 1982 (Cth)
              </p>
            </div>

            {/* Disclaimer */}
            <div style={{
              padding: '10px 16px',
              marginBottom: '24px',
              background: palette.disclaimerBg,
              border: `1px solid ${palette.disclaimerBorder}`,
              borderRadius: '8px',
              fontSize: '13px',
              color: palette.textMuted,
              lineHeight: '1.5'
            }}>
              <strong style={{ color: palette.noteStrong }}>Diagnostic tool.</strong> This visualiser maps the statutory decision pathway for educational purposes. It does not constitute legal advice or an authoritative interpretation of the FOI Act. Output should not be treated as evidence of agency conduct or exemption validity.
            </div>

            {/* Legend */}
            <div style={{
              display: 'flex',
              gap: '16px',
              marginBottom: '32px',
              flexWrap: 'wrap',
              padding: '16px',
              background: palette.legendBg,
              borderRadius: '8px',
              border: `1px solid ${palette.legendBorder}`
            }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                <div style={{ width: '12px', height: '12px', borderRadius: '2px', background: '#3b82f6' }}></div>
                <span style={{ fontSize: '12px', color: palette.textMuted }}>Decision point</span>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                <div style={{ width: '12px', height: '12px', borderRadius: '2px', background: '#ef4444' }}></div>
                <span style={{ fontSize: '12px', color: palette.textMuted }}>Absolute exemption</span>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                <div style={{ width: '12px', height: '12px', borderRadius: '2px', background: '#f59e0b' }}></div>
                <span style={{ fontSize: '12px', color: palette.textMuted }}>Conditional exemption</span>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                <div style={{ width: '12px', height: '12px', borderRadius: '2px', background: '#60a5fa' }}></div>
                <span style={{ fontSize: '12px', color: palette.textMuted }}>Process step</span>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                <div style={{ width: '12px', height: '12px', borderRadius: '2px', background: '#22c55e' }}></div>
                <span style={{ fontSize: '12px', color: palette.textMuted }}>Release</span>
              </div>
            </div>

            {/* Flowchart */}
            <div style={{
              background: palette.cardBg,
              border: `1px solid ${palette.cardBorder}`,
              borderRadius: '12px',
              padding: isMobile ? '20px' : '32px',
              overflowX: isMobile ? 'hidden' : 'auto'
            }}>
              {isMobile ? (
                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                  <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '8px' }}>
                    <StepBox step={steps.start} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <Arrow direction="down" color={palette.neutralArrow} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '16px' }}>
                    <StepBox step={steps.exemption} />
                  </div>

                  <div style={{ width: '100%', display: 'flex', flexDirection: 'column', gap: '16px' }}>
                    <div style={{ padding: '12px', borderRadius: '12px', border: `1px solid ${palette.sectionBorder}`, background: palette.sectionBg }}>
                      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                        <Arrow direction="down" label="No exemption" color="#22c55e" />
                        <StepBox step={steps.release} />
                      </div>
                    </div>

                    <div style={{ padding: '12px', borderRadius: '12px', border: `1px solid ${palette.sectionBorder}`, background: palette.sectionBg }}>
                      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                        <Arrow direction="down" label="Absolute (Div 2)" color="#ef4444" />
                        <StepBox step={steps.division2} />
                        <Arrow direction="down" label="To s 22" color="#ef4444" />
                      </div>
                    </div>

                    <div style={{ padding: '12px', borderRadius: '12px', border: `1px solid ${palette.sectionBorder}`, background: palette.sectionBg }}>
                      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                        <Arrow direction="down" label="Conditional (Div 3)" color="#f59e0b" />
                        <StepBox step={steps.division3} />
                        <Arrow direction="down" label="To PIT" color="#f59e0b" />
                        <StepBox step={steps.publicInterest} />

                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', width: '100%', marginTop: '8px', justifyItems: 'center' }}>
                          <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                            <Arrow direction="down" label="Favours access" color="#22c55e" />
                            <div style={{
                              padding: '8px 16px',
                              background: palette.chipReleaseBg,
                              border: '2px solid #22c55e',
                              borderRadius: '8px',
                              color: palette.chipReleaseText,
                              fontSize: '12px',
                              fontWeight: 600
                            }}>
                              → Release
                            </div>
                          </div>

                          <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                            <Arrow direction="down" label="Contrary to access" color="#ef4444" />
                            <div style={{
                              padding: '8px 16px',
                              background: palette.chipRefuseBg,
                              border: '2px solid #ef4444',
                              borderRadius: '8px',
                              color: palette.chipRefuseText,
                              fontSize: '12px',
                              fontWeight: 600
                            }}>
                              → s 22
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center', marginTop: '16px', marginBottom: '8px' }}>
                    <StepBox step={steps.editedCopy} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <Arrow direction="down" label="Prepare notice" color="#60a5fa" />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '8px' }}>
                    <StepBox step={steps.reasons} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <Arrow direction="down" label="With redactions" color="#22c55e" />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <div style={{
                      padding: '16px 24px',
                      background: palette.finalReleaseBg,
                      border: '2px solid #22c55e',
                      borderRadius: '8px',
                      textAlign: 'center'
                    }}>
                      <div style={{ fontWeight: 700, color: palette.finalReleaseText, fontSize: '16px' }}>
                        Release edited copy
                      </div>
                      <div style={{ fontSize: '12px', color: palette.finalReleaseSub, marginTop: '4px' }}>
                        s 11A(3), s 22
                      </div>
                    </div>
                  </div>
                </div>
              ) : (
                <>
                  <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '8px' }}>
                    <StepBox step={steps.start} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <Arrow direction="down" color={palette.neutralArrow} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '8px' }}>
                    <StepBox step={steps.exemption} />
                  </div>

                  <div style={{ display: 'grid', width: '100%', minWidth: '720px', gridTemplateColumns: 'repeat(3, minmax(220px, 1fr))', gap: '24px', marginBottom: '8px', justifyItems: 'center' }}>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <Arrow direction="down" label="No exemption" color="#22c55e" />
                    </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <Arrow direction="down" label="Absolute (Div 2)" color="#ef4444" />
                    </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <Arrow direction="down" label="Conditional (Div 3)" color="#f59e0b" />
                    </div>
                  </div>

                  <div style={{ display: 'grid', width: '100%', minWidth: '720px', gridTemplateColumns: 'repeat(3, minmax(220px, 1fr))', gap: '24px', marginBottom: '8px', justifyItems: 'center' }}>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <StepBox step={steps.release} />
                    </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <StepBox step={steps.division2} />
                    </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <StepBox step={steps.division3} />
                    </div>
                  </div>

                  <div style={{ display: 'grid', width: '100%', minWidth: '720px', gridTemplateColumns: 'repeat(3, minmax(220px, 1fr))', gap: '24px', marginBottom: '8px', justifyItems: 'center' }}>
                    <div></div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <Arrow direction="down" label="To s 22" color="#ef4444" />
                    </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <Arrow direction="down" label="To PIT" color="#f59e0b" />
                    </div>
                  </div>

                  <div style={{ display: 'grid', width: '100%', minWidth: '720px', gridTemplateColumns: 'repeat(3, minmax(220px, 1fr))', gap: '24px', marginBottom: '8px', justifyItems: 'center' }}>
                    <div></div>
                    <div></div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                      <StepBox step={steps.publicInterest} />
                    </div>
                  </div>

                  <div style={{ display: 'grid', width: '100%', minWidth: '720px', gridTemplateColumns: 'repeat(3, minmax(220px, 1fr))', gap: '24px', marginBottom: '8px', justifyItems: 'center' }}>
                    <div></div>
                    <div></div>
                    <div style={{ display: 'grid', width: '100%', minWidth: '420px', gridTemplateColumns: 'repeat(2, minmax(180px, 1fr))', gap: '24px', justifyItems: 'center' }}>
                      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                        <Arrow direction="down" label="Favours access" color="#22c55e" />
                        <div style={{
                          padding: '8px 16px',
                          background: palette.chipReleaseBg,
                          border: '2px solid #22c55e',
                          borderRadius: '8px',
                          color: palette.chipReleaseText,
                          fontSize: '12px',
                          fontWeight: 600
                        }}>
                          → Release
                        </div>
                      </div>
                      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                        <Arrow direction="down" label="Contrary to access" color="#ef4444" />
                        <div style={{
                          padding: '8px 16px',
                          background: palette.chipRefuseBg,
                          border: '2px solid #ef4444',
                          borderRadius: '8px',
                          color: palette.chipRefuseText,
                          fontSize: '12px',
                          fontWeight: 600
                        }}>
                          → s 22
                        </div>
                      </div>
                    </div>
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center', marginTop: '16px', marginBottom: '8px' }}>
                    <StepBox step={steps.editedCopy} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <Arrow direction="down" label="Prepare notice" color="#60a5fa" />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '8px' }}>
                    <StepBox step={steps.reasons} />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <Arrow direction="down" label="With redactions" color="#22c55e" />
                  </div>

                  <div style={{ display: 'flex', justifyContent: 'center' }}>
                    <div style={{
                      padding: '16px 24px',
                      background: palette.finalReleaseBg,
                      border: '2px solid #22c55e',
                      borderRadius: '8px',
                      textAlign: 'center'
                    }}>
                      <div style={{ fontWeight: 700, color: palette.finalReleaseText, fontSize: '16px' }}>
                        Release edited copy
                      </div>
                      <div style={{ fontSize: '12px', color: palette.finalReleaseSub, marginTop: '4px' }}>
                        s 11A(3), s 22
                      </div>
                    </div>
                  </div>
                </>
              )}
            </div>

            {/* Footer note */}
            <div style={{
              marginTop: '24px',
              padding: '16px',
              background: palette.noteBg,
              border: `1px solid ${palette.noteBorder}`,
              borderRadius: '8px',
              fontSize: '13px',
              color: palette.textMuted
            }}>
              <strong style={{ color: palette.noteStrong }}>Note:</strong> Click any box to view the relevant section on AustLII.
              This visualiser shows the standard pathway; actual decisions may involve multiple exemptions,
              partial redactions, and iterative assessment of individual documents within a release pack.
            </div>

            {/* Attribution */}
            <div style={{
              marginTop: '24px',
              paddingTop: '24px',
              borderTop: `1px solid ${palette.attrBorder}`,
              fontSize: '12px',
              color: palette.attrText
            }}>
              GlassCase ·
              FOI Redaction Logic Visualiser ·
              Part of the Redaction Taxonomy v0.2 ·
              CC BY 4.0
            </div>
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<RedactionFlowVisualizer />);

    (function() {
      function postHeight() {
        const h = Math.max(
          document.body.scrollHeight,
          document.documentElement.scrollHeight,
          document.body.offsetHeight,
          document.documentElement.offsetHeight
        );
        if (window.parent && window.parent !== window) {
          window.parent.postMessage({ type: 'visualiserHeight', height: h }, '*');
        }
      }

      window.addEventListener('load', postHeight);
      window.addEventListener('resize', postHeight);

      const ro = new ResizeObserver(() => postHeight());
      ro.observe(document.documentElement);

      setTimeout(postHeight, 50);
      setTimeout(postHeight, 250);
      setTimeout(postHeight, 750);
    })();
  </script>
</body>
</html>
